(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],[,,,,,,function(e,t,n){e.exports=n(17)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(5),i=n.n(o),l=(n(11),n(1)),c=function(e,t,n){return new Array(10).fill(null).map((function(){return new Array(10).fill(n)}))};function u(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function s(e,t){for(var n=typeof e,r=[],a=e+"",o=0;o<t;o++)"number"===n?r[o]=e+o:"string"===n&&(r[o]=String.fromCharCode(a.charCodeAt(0)+o));return r}function d(e,t,n,r){var a=n[e][t],o={};if(0===a)o={arr:v(e,t,3,n),result:"missed"};else if(1===a){var i=v(e,t,2,n),l=function(e,t,n){var r=E(n),a=!0;!function e(t,o){p(t,o,n)||(a=!1);for(var i=t-1;i<=t+1;i++)for(var l=o-1;l<=o+1;l++)S(i,l)||(2===r[i][l]&&(r[i][l]=3,e(i,l)),r[i][l]=3)}(e,t);for(var o=0;o<n.length;o++)for(var i=0;i<n[o].length;i++)2===n[o][i]&&(r[o][i]=2);return{cells:r,isLastHittedCell:a}}(e,t,i);o=l.isLastHittedCell?{arr:l.cells,result:"killed"}:{arr:i,result:"hitted"}}else o={arr:n,result:""};return r(o.arr),function(e){for(var t=0,n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)2===e[n][r]&&t++;return 20===t}(o.arr)&&(o.result="win"),o}function f(e){var t=E(e),n={};return n[4]=[m(4,t)],n[3]=y(2,3,t),n[2]=y(3,2,t),n[1]=y(4,1,t),{cells:t,positions:n}}function p(e,t,n){for(var r=e-1;r<=e+1;r++)for(var a=t-1;a<=t+1;a++)if(!(S(r,a)||r===e&&a===t)&&1===n[r][a])return!1;return!0}function v(e,t,n,r){var a=E(r);return a[e][t]=n,a}function y(e,t,n){for(var r=[],a=0;a<e;a++){var o=m(t,n);r.push(o)}return r}function m(e,t){for(var n=x(e);!b(n,t);)n=x(e);for(var r=0;r<n.length;r++)t[n[r].x][n[r].y]=1;return n}function h(e,t){var n=E(t);if(!b(e,t))return null;for(var r=0;r<e.length;r++)n[e[r].x][e[r].y]=1;return n}function g(e,t){for(var n=E(t),r=0;r<e.length;r++)n[e[r].x][e[r].y]=0;return n}function x(e){var t=[];if(Math.random()<.5)for(var n=k(10,10-e),r=n.x,a=n.y,o=0;o<e;o++)t.push({x:r,y:a+o});else for(var i=k(10-e,10),l=i.x,c=i.y,u=0;u<e;u++)t.push({x:l+u,y:c});return t}function b(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=r.x,o=r.y;if(a>=10||o>=10)return!1;if(!p(a,o,t)||1===t[a][o])return!1}return!0}function S(e,t){return e<0||t<0||e>9||t>9}function E(e){return e.map((function(e){return e.slice()}))}function k(e,t){return{x:u(0,e),y:u(0,t)}}var O=[];function N(e,t,n,r){var a,o=d((a=O.length?function(e){var t=function(e){var t=[];if(1===(O=O.sort((function(e,t){return e.x<t.x||e.y<t.y?-1:1}))).length){var n=O[0],r=n.x,a=n.y;t=[{x:r-1,y:a},{x:r+1,y:a},{x:r,y:a-1},{x:r,y:a+1}]}else{var o=O[0],i=o.x,l=o.y,c=O[O.length-1],u=c.x,s=c.y;t=i!==u?[{x:i-1,y:l},{x:u+1,y:s}]:[{x:i,y:l-1},{x:u,y:s+1}]}return t=t.filter((function(t){if(S(t.x,t.y))return!1;var n=e[t.x][t.y];return 0===n||1===n}))}(e),n=u(0,t.length),r=t[n];1===e[r.x][r.y]&&O.push({x:r.x,y:r.y});return r}(e):function(e){for(var t=[],n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)0!==e[n][r]&&1!==e[n][r]||t.push({x:n,y:r});if(0===t.length)return;var a=t[u(0,t.length)];1===e[a.x][a.y]&&O.push({x:a.x,y:a.y});return a}(e)).x,a.y,e,t);return"win"===o.result?r():"missed"===o.result?n():("killed"===o.result&&w(),setTimeout((function(){N(o.arr,t,n,r)}),500)),o}function w(){O=[]}n(12),n(13);var j=function(e){var t=e.cellValue,n=e.highlight,r="",o="";return 2===t?(r="hitted-cell",o="\u2573"):3===t&&(r="missed-cell",o="\u25cf"),1===t&&n&&(r+=" highlight-cell"),a.a.createElement("td",{className:r},o)};j=a.a.memo(j);n(14);var C=function(e){var t=e.cellsArray,n=e.clickCallback,r=e.cellsHighlight,o=e.player,i=t.map((function(e,t){var n=e.map((function(e,t){return a.a.createElement(j,{key:"cell-"+t,cellValue:e,highlight:r})}));return a.a.createElement("tr",{key:"row-"+t},n)}));return a.a.createElement("div",{className:"battlefield"},a.a.createElement("div",{className:"numeration numeration-v"},s(1,10).map((function(e,t){return a.a.createElement("span",{key:"nums"+t},e)}))),a.a.createElement("div",null,a.a.createElement("div",{className:"numeration"},s("A",10).map((function(e,t){return a.a.createElement("span",{key:"letters"+t},e)}))),a.a.createElement("table",{className:o&&"player-table",onClick:function(e){var t=e.target;"TD"===t.nodeName&&n&&n(t.parentNode.rowIndex,t.cellIndex)}},a.a.createElement("tbody",null,i))))},R=n(3),A=n(2),D=n.n(A),q=(n(15),function(e){var t=document.querySelector("td").getBoundingClientRect(),n=t.width,r=t.height,a=document.querySelector(".dropzone");return{top:e[0].x*(r+1)+a.offsetTop,left:e[0].y*(n+1)}}),J=function(e){var t=e.id,n=e.position,o=e.rotate,i=e.dropped,l=e.valid,c=e.onShipDrop,u=e.onShipDragStart,s=e.onShipRotate,d=e.updateShip,f=+t[0],p=Object(r.useCallback)((function(e,n,r,a){d(t,e,n,r,a)}),[d,t]),v=Object(r.useCallback)((function(e){p({x:0,y:0},0,!1,!0)}),[p]);Object(r.useEffect)((function(){D()("#draggable"+t).draggable({listeners:{start:function(e){if(p(n,o,i,!0),i){var t=e.target,r=JSON.parse(t.dataset.indices);u(r)}},move:function(e){p({x:n.x+e.dx,y:n.y+e.dy},o,i,l)},end:function(e){var t=e.relatedTarget,n=e.target;if(t){var r=function(e,t,n,r){for(var a=e.getBoundingClientRect(),o=a.top,i=a.left,l=t.getBoundingClientRect(),c=l.top,u=l.left,s=l.width,d=l.height,f=Math.round((i-u)/s*10),p=Math.round((o-c)/d*10),v=[],y=0;y<n;y++)v.push(r?{x:p+y,y:f}:{x:p,y:f+y});return v}(n,t,f,o);n.dataset.indices=JSON.stringify(r);var a=q(r),i=a.top,l=a.left,u=c(r);p({x:l,y:i},o,!0,u)}else v(n)}}})}),[u,c,t,n,o,i,l,f,p,v]);var y=0,m=0;i||(y=4,m=4,4===f&&(y=92),3===f&&(y=122,m+=40),2===f&&(m+=40));for(var h={transform:"rotate("+o+"deg)",top:n.y+m+"px",left:n.x+y+"px"},g=[],x=0;x<f;x++)g.push(a.a.createElement("td",{key:"draggable-cell"+x+f}));return a.a.createElement("div",{id:"draggable"+t,className:"draggable "+(!l&&"error"),style:h},i&&a.a.createElement("div",null,f>1&&a.a.createElement("button",{onClick:function(){var e=document.querySelector("#draggable"+t),r=JSON.parse(e.dataset.indices),a=r.map((function(e,t){var n=o>0?-1:1;return{x:e.x+n*t,y:e.y-n*t}})),l=s(r,a),c=r[0].x>10-f||r[0].y>10-f,u=o>0?0:90;c&&(u=o),p({x:n.x,y:n.y},u,i,l),l&&(e.dataset.indices=JSON.stringify(a))},className:"rotate-btn"},"\u21bb"),a.a.createElement("button",{onClick:function(){var e=document.querySelector("#draggable"+t);u(JSON.parse(e.dataset.indices)),v(e)},className:"delete-btn"},"X")),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,g))))},M=function(e){var t=e.children;return Object(r.useEffect)((function(){D()(".dropzone").dropzone({accept:".draggable",overlap:.9});var e=document.querySelector(".dropzone"),t=document.querySelector(".player-table"),n=document.querySelector(".ship-picker");e.style.top=t.offsetTop-n.offsetTop+"px",e.style.width=t.offsetWidth+"px",e.style.height=t.offsetHeight+"px"}),[]),a.a.createElement("div",{className:"dropzone"},t)},T=(n(16),{"1-1":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"1-2":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"1-3":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"1-4":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"2-1":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"2-2":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"2-3":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"3-1":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"3-2":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0},"4-1":{position:{x:0,y:0},rotate:0,dropped:!1,valid:!0}}),B=function(e){var t=e.onShipDrop,n=e.onShipDragStart,o=e.onSetRandom,i=e.onShipRotate,c=e.onReady,u=e.onResetAll,s=e.visible,d=Object(r.useState)(T),f=Object(l.a)(d,2),p=f[0],v=f[1];Object(r.useEffect)((function(){var e=!0;for(var t in p)e&=p[t].dropped&&p[t].valid;c(e)}));var y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=Object(R.a)({},p);o[e]={position:t,rotate:n,dropped:r,valid:a},v(o)},m=[];for(var h in p){var g=p[h],x=g.position,b=g.rotate,S=g.dropped,E=g.valid;m.push(a.a.createElement(J,{key:h,id:h,position:x,rotate:b,dropped:S,valid:E,onShipDrop:t,onShipDragStart:n,onShipRotate:i,updateShip:y}))}return a.a.createElement("div",{className:"ship-picker",style:{display:s?"flex":"none"}},m,a.a.createElement("div",{className:"button-container"},a.a.createElement("button",{onClick:function(){u(),v(T)}},"\u2716"),a.a.createElement("button",{onClick:function(){var e=o(),t=Object(R.a)({},p);for(var n in e)for(var r=e[n],a=0;a<r.length;a++){var i=n+"-"+(a+1);document.querySelector("#draggable"+i).dataset.indices=JSON.stringify(r[a]);var l=q(r[a]),c=l.top,u=l.left,s=n>1&&r[a][0].x!==r[a][1].x?90:0;t[i]={position:{x:u,y:c},dropped:!0,rotate:s,valid:!0}}v(t)}},a.a.createElement("span",{role:"img","aria-label":"dice"},"\ud83c\udfb2"))),a.a.createElement(M,null))},H=null,z=function(){return f(c(0,0,0)).cells},W=c(0,0,0),I=z(),P=function(){var e=Object(r.useState)(W),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(r.useState)(I),u=Object(l.a)(i,2),s=u[0],p=u[1],v=Object(r.useState)("Player"),y=Object(l.a)(v,2),m=y[0],x=y[1],b=Object(r.useState)(0),S=Object(l.a)(b,2),E=S[0],k=S[1],O=Object(r.useState)(!0),j=Object(l.a)(O,2),R=j[0],A=j[1],D=0===E?"Start":"Restart",q="";return 0===E&&(q="Setup your field"),2===E&&(q=m+" Wins!"),1===E&&(q=m+" turn"),a.a.createElement("div",{className:"app"},a.a.createElement("div",{className:"game-container"},a.a.createElement("div",{className:"info-container"},a.a.createElement("span",{className:2===E?"highlight-info":""},q),a.a.createElement("button",{className:"game-btn",onClick:function(){0===E?(x("Player"),k(1),H=n.map((function(e){return e.slice()})),w()):(k(0),o(H||W),H=null,p(z()))},disabled:R},D)),a.a.createElement(B,{onShipDrop:function(e){var t=h(e,n);return null!==t&&(o(t),!0)},onShipDragStart:function(e){o(g(e,n))},onSetRandom:function(){var e=f(c(0,0,0));return o(e.cells),e.positions},onShipRotate:function(e,t){var r=g(e,n),a=h(t,r);return null===a?(o(r),!1):(o(a),!0)},onReady:function(e){A(!Boolean(e))},onResetAll:function(){o(W)},visible:0===E}),a.a.createElement(C,{cellsArray:n,cellsHighlight:!0,player:!0}),a.a.createElement(C,{cellsArray:s,clickCallback:function(e,t){if(1===E&&"Ai"!==m){var r=d(e,t,s,p);if("win"===r.result)return k(2),void alert("You win!");"missed"===r.result&&(x("Ai"),setTimeout((function(){N(n,o,(function(){x("Player")}),(function(){k(2),alert("Ai wins!")}))}),500))}},cellsHighlight:2===E})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[6,1,2]]]);
//# sourceMappingURL=main.0480470c.chunk.js.map